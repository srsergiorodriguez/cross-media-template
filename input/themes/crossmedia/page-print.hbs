<!DOCTYPE html>
<html lang="{{@website.language}}">
  <head>
    <meta charset="utf-8">
    <title>{{title}} - {{@website.name}}</title>
    
    <style>
      body {
        background-color: gray;
      }

      #page-entry {
        font-family: serif;
        font-size: 11pt;
        line-height: 1.3;
        color: #000;
        text-align: justify;
        text-align-last: left;
      }
      
      #page-entry p {
        orphans: 2; /* Minimum lines at the bottom of a page */
        widows: 2;  /* Minimum lines at the top of a page */
      }

      h1, h2, h3, h4, h5, h6 {
        text-align: left;
        text-align-last: left;
        break-after: avoid;
      }

      h1 { font-family: sans-serif; text-align: center; text-align-last: center; margin-bottom: 2rem; }

      img { 
        max-width: 100% !important; 
        height: auto !important; /* lock aspect ratio */
        break-inside: avoid; 
        display: block;
        margin: 0 auto;
      }

      /* --- PUBLII IMAGE CLASSES FOR PRINT (PAGED.JS SAFE) --- */

      figure.post__image {
        display: block !important;
        width: 100% !important;
        margin: 0.5rem 0 !important;
        overflow: hidden !important; /* Acts as a clearfix so text stays below */
        break-inside: avoid; /* Prevents the image/caption from splitting across pages */
      }
      figure.post__image--left {
        float: left !important;
        width: 60% !important; 
        margin: 0 !important;
      }
      figure.post__image--left + figcaption {
        float: right !important; /* Float to the opposite side */
        clear: none !important;  /* Do NOT push under the image */
        width: 35% !important;   /* Leaves a 5% gap in the middle */
        text-align: left !important; /* Hugs the text towards the image */
        text-align-last: left !important;
        margin: 0 !important;
      }
      figure.post__image--right {
        float: right !important;
        width: 60% !important;
        margin: 0 !important;
      }
      figure.post__image--right + figcaption {
        float: left !important;
        clear: none !important;
        width: 35% !important;
        text-align: right !important;
        text-align-last: right !important;
        margin: 0 !important;
      }
      figure.post__image--center {
        display: block !important;
        float: none !important;
        margin: 0.5rem auto !important;
      }
      figure.post__image--center + figcaption {
        text-align: center !important;
        text-align-last: center !important;
        width: 100% !important;
      }
      figure.post__image--wide,
      figure.post__image--full {
        display: block !important;
        float: none !important;
        width: 100% !important;
        margin: 0.5rem 0 !important;
      }
      
      /* Base Caption Defaults */
      figcaption {
        font-family: sans-serif;
        font-size: 8pt;
        color: #555;
        margin-top: 0.5rem;
        display: block;
      }

      @page {
        /* size: letter;
        margin: 25mm 20mm;
        */
        size: 5.5in 8.5in; /* Half letter */
        margin: 20mm 13mm 20mm 13mm; /* top, right, bottom, left */

        @top-center {
          content: "{{@website.name}}"; /* Project name */
          font-family: sans-serif;
          font-size: 8pt;
          color: #666;
        }
      }

      /* EVEN PAGES (Left side of the spread) */
      @page :left {
        margin-right: 16mm;
        margin-left: 40mm; /* Uncomment this when using sidenotes */

        @top-left {
          content: counter(page);
          font-family: sans-serif;
          font-size: 8pt;
        }
      }

      /* ODD PAGES (Right side of the spread) */
      @page :right {
        margin-left: 16mm;
        margin-right: 40mm; /* Uncomment this when using sidenotes */
        @top-right {
          content: counter(page);
          font-family: sans-serif;
          font-size: 8pt;
        }
      }

      @media print {
        .pagedjs_pages {
          display: block !important;
          padding: 0 !important;
        }
        .pagedjs_page {
          background-color: white;
          margin: 0 !important;
          border: none !important;
          margin-bottom: 10px !important;
        }
      }

      /* --- SIDENOTES --- */
      .sidenote {
        width: 25mm;
        font-family: sans-serif;
        font-size: 7.5pt;
        line-height: 1.3;
        clear: both;
        text-align: left;
        text-align-last: left;
      }

      /* On Left pages, push the note into the left margin */
      .pagedjs_left_page .sidenote {
        float: left;
        margin-left: -30mm;
      }

      /* On Right pages, push the note into the right margin */
      .pagedjs_right_page .sidenote {
        float: right;
        margin-right: -30mm;
      }
      
    </style>

    <style data-pagedjs-ignore>
      /* Style for the floating modal */
      .zine-instructions {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #fff;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        width: 300px;
        font-family: sans-serif;
        z-index: 9999;
      }
      
      .zine-instructions code {
        display: block;
        background: #eee;
        padding: 8px;
        margin: 10px 0;
        font-size: 11px;
      }
      
      @media print {
        /* When you hit Ctrl+P, the browser reads this and hides the modal from the PDF */
        .zine-instructions {
          display: none !important;
        }
      }
    </style>

  </head>

  <body>
    <main class="page print-container">
      {{#page}}
        <article>
          <header class="print-cover">
            <h1>{{title}}</h1>
          </header>

          <div id="page-entry">
            {{{text}}}
          </div>

        </article>
      {{/page}}
    </main>

    <div class="zine-instructions">
      <h3>üñ®Ô∏è Instrucciones de compaginaci√≥n para formato fanzine</h3>
      <p>Este documento est√° formateado en p√°ginas secuenciales de tama√±o <strong>Media Carta</strong>.</p>
      <ol>
        <li>Usa el siguiente bot√≥n para producir un pdf con las p√°ginas ordenadas secuencialmente: <button onclick="window.print()">Generar PDF Secuencial</button></li>
        <li>Para generar el formato cuadernillo (o <em>booklet</em>) para impresi√≥n f√≠sica, recomendamos usar la aplicaci√≥n <a href="https://pdfcpu.io/" target="_blank">pdfcpu</a>. Pon el archivo descargado y pdfcpu en la misma carpet, y en tu terminal usa el siguiente comando:</li>
      </ol>
      <code>pdfcpu booklet fanzine-impreso.pdf tu-archivo-descargado.pdf</code>
    </div>

    <script defer src="{{@website.assetsUrl}}/js/paged.polyfill.js"></script>

  </body>
</html>